
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Period Boundary Viewer</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .control-group label {
            font-weight: bold;
            font-size: 12px;
            color: #666;
        }
        
        select, button, input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        button {
            background-color: #007bff;
            color: white;
            cursor: pointer;
            border: none;
        }
        
        button:hover {
            background-color: #0056b3;
        }
        
        button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        
        .danger-btn {
            background-color: #dc3545;
        }
        
        .danger-btn:hover {
            background-color: #c82333;
        }
        
        .success-btn {
            background-color: #28a745;
        }
        
        .success-btn:hover {
            background-color: #218838;
        }
        
        .info-panel {
            background-color: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #007bff;
        }
        
        .well-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }
        
        .info-label {
            font-weight: bold;
            color: #666;
        }
        
        .plot-container {
            height: 600px;
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        
        .period-list {
            margin-top: 20px;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }
        
        .period-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin: 5px 0;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .period-item:hover {
            background-color: #f0f0f0;
        }
        
        .modifications {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            display: none;
        }
        
        .modifications.show {
            display: block;
        }
        
        .export-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }
        
        #plotly-div {
            width: 100%;
            height: 100%;
        }
        
        .status-message {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            display: none;
        }
        
        .status-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üî¨ Interactive Period Boundary Viewer</h1>
            <p>Visualize and manually correct media change period splits for organoid oxygen consumption data</p>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label for="wellSelect">Select Well:</label>
                <select id="wellSelect" onchange="loadWell()">
                    <option value="">Choose a well...</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="addPeriodTime">Add Period Boundary:</label>
                <input type="number" id="addPeriodTime" placeholder="Time (hours)" step="0.1">
                <button onclick="addPeriodBoundary()">Add Boundary</button>
            </div>
            
            <div class="control-group">
                <label>Actions:</label>
                <button onclick="resetPeriods()" class="danger-btn">Reset to Original</button>
                <button onclick="autoDetectPeriods()">Auto-Detect</button>
                <button onclick="exportCorrections()" class="success-btn">Export Corrections</button>
            </div>
        </div>
        
        <div class="status-message" id="statusMessage"></div>
        
        <div class="info-panel" id="wellInfo" style="display: none;">
            <div class="well-info" id="wellInfoContent"></div>
        </div>
        
        <div class="plot-container">
            <div id="plotly-div"></div>
        </div>
        
        <div class="period-list" id="periodList" style="display: none;">
            <h3>Current Periods</h3>
            <div id="periodItems"></div>
        </div>
        
        <div class="modifications" id="modifications">
            <h3>‚ö†Ô∏è Modifications Made</h3>
            <div id="modificationsList"></div>
        </div>
        
        <div class="export-section">
            <h3>Export Corrected Data</h3>
            <p>After making corrections, export the updated period boundaries for use in analysis.</p>
            <button onclick="downloadCorrections()" class="success-btn">Download JSON</button>
            <button onclick="copyToClipboard()">Copy to Clipboard</button>
        </div>
    </div>

    <script>
        // Global variables
        let wellsData = [
  {
    "well_id": "06e6ebb9-f553-48e8-a894-c3d02328f599_49",
    "plate_id": "06e6ebb9-f553-48e8-a894-c3d02328f599",
    "drug": "Sunitinib",
    "concentration": 0.03,
    "time_series": {
      "time": [
        0.15,
        2.066666666666667,
        3.75,
        4.683333333333334,
        6.2,
        7.133333333333334,
        8.066666666666666,
        9.0,
        9.933333333333334,
        10.866666666666667,
        11.8,
        12.75,
        25.95,
        26.9,
        27.85,
        28.816666666666666,
        29.766666666666666,
        30.716666666666665,
        31.666666666666668,
        32.61666666666667,
        33.583333333333336,
        34.53333333333333,
        35.483333333333334,
        36.45,
        37.4,
        38.36666666666667,
        39.31666666666667,
        40.28333333333333,
        41.25,
        42.2,
        43.166666666666664,
        44.13333333333333,
        45.083333333333336,
        46.05,
        47.016666666666666,
        47.983333333333334,
        48.95,
        49.916666666666664,
        50.88333333333333,
        51.85,
        52.81666666666667,
        53.78333333333333,
        54.75,
        55.71666666666667,
        56.68333333333333,
        57.666666666666664,
        58.63333333333333,
        59.6,
        60.583333333333336,
        61.55,
        62.53333333333333,
        63.5,
        64.48333333333333,
        65.45,
        66.43333333333334,
        67.41666666666667,
        68.4,
        69.38333333333334,
        70.38333333333334,
        71.36666666666666,
        72.35,
        73.35,
        74.33333333333333,
        76.43333333333334,
        77.41666666666667,
        78.4,
        79.38333333333334,
        80.36666666666666,
        81.35,
        82.33333333333333,
        83.33333333333333,
        84.31666666666666,
        85.3,
        86.28333333333333,
        87.28333333333333,
        88.26666666666667,
        89.25,
        90.25,
        91.25,
        92.25,
        342.1666666666667,
        342.4166666666667,
        343.35,
        344.28333333333336,
        345.21666666666664,
        346.15,
        347.0833333333333,
        348.01666666666665,
        348.96666666666664,
        349.9,
        350.8333333333333,
        351.78333333333336,
        352.71666666666664,
        353.65,
        354.6,
        355.53333333333336,
        356.48333333333335,
        357.4166666666667,
        358.3666666666667,
        359.31666666666666,
        360.25,
        361.2,
        362.15,
        363.1,
        364.03333333333336,
        364.98333333333335,
        365.93333333333334,
        366.8833333333333,
        367.8333333333333,
        402.71666666666664,
        403.7,
        404.68333333333334,
        405.65,
        406.6333333333333,
        407.6166666666667,
        408.6,
        409.5833333333333,
        410.56666666666666,
        426.75,
        427.75,
        428.75
      ],
      "oxygen": [
        -4.449999809265137,
        -4.800000190734863,
        -4.449999809265137,
        -5.150000095367432,
        31.350000381469727,
        6.75,
        -2.200000047683716,
        -3.5,
        -4.550000190734863,
        -4.5,
        -3.6500000953674316,
        -4.25,
        -5.75,
        -6.0,
        -4.150000095367432,
        -6.650000095367432,
        -4.900000095367432,
        -5.650000095367432,
        -5.199999809265137,
        -4.050000190734863,
        -4.800000190734863,
        -5.449999809265137,
        -5.300000190734863,
        -3.950000047683716,
        -5.599999904632568,
        -4.900000095367432,
        -5.099999904632568,
        -4.849999904632568,
        -5.5,
        -4.550000190734863,
        -5.800000190734863,
        -6.150000095367432,
        -4.449999809265137,
        -4.900000095367432,
        -5.650000095367432,
        -6.0,
        -4.099999904632568,
        -6.25,
        -5.650000095367432,
        -3.950000047683716,
        -3.450000047683716,
        -4.449999809265137,
        -5.050000190734863,
        -5.650000095367432,
        -5.150000095367432,
        -5.150000095367432,
        -5.599999904632568,
        -4.5,
        -4.099999904632568,
        -4.949999809265137,
        -4.050000190734863,
        -3.8499999046325684,
        -5.650000095367432,
        -5.650000095367432,
        -4.949999809265137,
        -7.300000190734863,
        -4.349999904632568,
        -7.349999904632568,
        -5.550000190734863,
        -1.149999976158142,
        -7.25,
        -4.5,
        0.75,
        -4.550000190734863,
        -2.700000047683716,
        -5.199999809265137,
        -1.2999999523162842,
        -2.950000047683716,
        -6.300000190734863,
        -6.050000190734863,
        -4.400000095367432,
        -2.4000000953674316,
        -2.9000000953674316,
        2.5,
        -4.199999809265137,
        -1.350000023841858,
        -5.0,
        -1.399999976158142,
        -4.949999809265137,
        -7.900000095367432,
        -5.599999904632568,
        -4.400000095367432,
        -4.25,
        -5.400000095367432,
        -4.650000095367432,
        -4.599999904632568,
        -3.8499999046325684,
        -4.0,
        -3.950000047683716,
        -2.9000000953674316,
        -3.9000000953674316,
        -4.199999809265137,
        -3.8499999046325684,
        -4.449999809265137,
        -3.450000047683716,
        -4.599999904632568,
        -4.800000190734863,
        -4.300000190734863,
        -4.300000190734863,
        -4.650000095367432,
        -4.650000095367432,
        -4.849999904632568,
        -5.449999809265137,
        -4.5,
        -5.099999904632568,
        -4.349999904632568,
        -5.300000190734863,
        -4.75,
        -4.449999809265137,
        -5.949999809265137,
        -5.599999904632568,
        -5.449999809265137,
        -5.75,
        -6.25,
        -4.650000095367432,
        -5.349999904632568,
        -5.0,
        -5.650000095367432,
        -5.300000190734863,
        -5.150000095367432,
        -5.349999904632568
      ],
      "timestamps": [
        "2024-05-09 18:01:00+03:00",
        "2024-05-09 19:56:00+03:00",
        "2024-05-09 21:37:00+03:00",
        "2024-05-09 22:33:00+03:00",
        "2024-05-10 00:04:00+03:00",
        "2024-05-10 01:00:00+03:00",
        "2024-05-10 01:56:00+03:00",
        "2024-05-10 02:52:00+03:00",
        "2024-05-10 03:48:00+03:00",
        "2024-05-10 04:44:00+03:00",
        "2024-05-10 05:40:00+03:00",
        "2024-05-10 06:37:00+03:00",
        "2024-05-10 19:49:00+03:00",
        "2024-05-10 20:46:00+03:00",
        "2024-05-10 21:43:00+03:00",
        "2024-05-10 22:41:00+03:00",
        "2024-05-10 23:38:00+03:00",
        "2024-05-11 00:35:00+03:00",
        "2024-05-11 01:32:00+03:00",
        "2024-05-11 02:29:00+03:00",
        "2024-05-11 03:27:00+03:00",
        "2024-05-11 04:24:00+03:00",
        "2024-05-11 05:21:00+03:00",
        "2024-05-11 06:19:00+03:00",
        "2024-05-11 07:16:00+03:00",
        "2024-05-11 08:14:00+03:00",
        "2024-05-11 09:11:00+03:00",
        "2024-05-11 10:09:00+03:00",
        "2024-05-11 11:07:00+03:00",
        "2024-05-11 12:04:00+03:00",
        "2024-05-11 13:02:00+03:00",
        "2024-05-11 14:00:00+03:00",
        "2024-05-11 14:57:00+03:00",
        "2024-05-11 15:55:00+03:00",
        "2024-05-11 16:53:00+03:00",
        "2024-05-11 17:51:00+03:00",
        "2024-05-11 18:49:00+03:00",
        "2024-05-11 19:47:00+03:00",
        "2024-05-11 20:45:00+03:00",
        "2024-05-11 21:43:00+03:00",
        "2024-05-11 22:41:00+03:00",
        "2024-05-11 23:39:00+03:00",
        "2024-05-12 00:37:00+03:00",
        "2024-05-12 01:35:00+03:00",
        "2024-05-12 02:33:00+03:00",
        "2024-05-12 03:32:00+03:00",
        "2024-05-12 04:30:00+03:00",
        "2024-05-12 05:28:00+03:00",
        "2024-05-12 06:27:00+03:00",
        "2024-05-12 07:25:00+03:00",
        "2024-05-12 08:24:00+03:00",
        "2024-05-12 09:22:00+03:00",
        "2024-05-12 10:21:00+03:00",
        "2024-05-12 11:19:00+03:00",
        "2024-05-12 12:18:00+03:00",
        "2024-05-12 13:17:00+03:00",
        "2024-05-12 14:16:00+03:00",
        "2024-05-12 15:15:00+03:00",
        "2024-05-12 16:15:00+03:00",
        "2024-05-12 17:14:00+03:00",
        "2024-05-12 18:13:00+03:00",
        "2024-05-12 19:13:00+03:00",
        "2024-05-12 20:12:00+03:00",
        "2024-05-12 22:18:00+03:00",
        "2024-05-12 23:17:00+03:00",
        "2024-05-13 00:16:00+03:00",
        "2024-05-13 01:15:00+03:00",
        "2024-05-13 02:14:00+03:00",
        "2024-05-13 03:13:00+03:00",
        "2024-05-13 04:12:00+03:00",
        "2024-05-13 05:12:00+03:00",
        "2024-05-13 06:11:00+03:00",
        "2024-05-13 07:10:00+03:00",
        "2024-05-13 08:09:00+03:00",
        "2024-05-13 09:09:00+03:00",
        "2024-05-13 10:08:00+03:00",
        "2024-05-13 11:07:00+03:00",
        "2024-05-13 12:07:00+03:00",
        "2024-05-13 13:07:00+03:00",
        "2024-05-13 14:07:00+03:00",
        "2024-05-24 00:02:00+03:00",
        "2024-05-24 00:17:00+03:00",
        "2024-05-24 01:13:00+03:00",
        "2024-05-24 02:09:00+03:00",
        "2024-05-24 03:05:00+03:00",
        "2024-05-24 04:01:00+03:00",
        "2024-05-24 04:57:00+03:00",
        "2024-05-24 05:53:00+03:00",
        "2024-05-24 06:50:00+03:00",
        "2024-05-24 07:46:00+03:00",
        "2024-05-24 08:42:00+03:00",
        "2024-05-24 09:39:00+03:00",
        "2024-05-24 10:35:00+03:00",
        "2024-05-24 11:31:00+03:00",
        "2024-05-24 12:28:00+03:00",
        "2024-05-24 13:24:00+03:00",
        "2024-05-24 14:21:00+03:00",
        "2024-05-24 15:17:00+03:00",
        "2024-05-24 16:14:00+03:00",
        "2024-05-24 17:11:00+03:00",
        "2024-05-24 18:07:00+03:00",
        "2024-05-24 19:04:00+03:00",
        "2024-05-24 20:01:00+03:00",
        "2024-05-24 20:58:00+03:00",
        "2024-05-24 21:54:00+03:00",
        "2024-05-24 22:51:00+03:00",
        "2024-05-24 23:48:00+03:00",
        "2024-05-25 00:45:00+03:00",
        "2024-05-25 01:42:00+03:00",
        "2024-05-26 12:35:00+03:00",
        "2024-05-26 13:34:00+03:00",
        "2024-05-26 14:33:00+03:00",
        "2024-05-26 15:31:00+03:00",
        "2024-05-26 16:30:00+03:00",
        "2024-05-26 17:29:00+03:00",
        "2024-05-26 18:28:00+03:00",
        "2024-05-26 19:27:00+03:00",
        "2024-05-26 20:26:00+03:00",
        "2024-05-27 12:37:00+03:00",
        "2024-05-27 13:37:00+03:00",
        "2024-05-27 14:37:00+03:00"
      ]
    },
    "period_boundaries": [
      {
        "start": 2.7398369444444444,
        "end": 162.4787836111111,
        "period_number": 2,
        "duration": 159.73894666666666,
        "data_points": 78
      },
      {
        "start": 334.1166666666667,
        "end": 428.75,
        "period_number": 5,
        "duration": 94.63333333333333,
        "data_points": 40
      }
    ],
    "media_change_events": [
      2.7398369444444444,
      162.4787836111111,
      266.0209947222222,
      334.1166666666667
    ],
    "data_range": {
      "time_min": 0.15,
      "time_max": 428.75,
      "oxygen_min": -7.900000095367432,
      "oxygen_max": 31.350000381469727
    }
  },
  {
    "well_id": "06e6ebb9-f553-48e8-a894-c3d02328f599_97",
    "plate_id": "06e6ebb9-f553-48e8-a894-c3d02328f599",
    "drug": "Sunitinib",
    "concentration": 0.09,
    "time_series": {
      "time": [
        0.26666666666666666,
        3.8666666666666667,
        4.8,
        6.316666666666666,
        7.25,
        8.183333333333334,
        9.116666666666667,
        10.05,
        10.983333333333333,
        11.916666666666666,
        25.116666666666667,
        26.066666666666666,
        27.016666666666666,
        27.983333333333334,
        28.933333333333334,
        29.883333333333333,
        30.833333333333332,
        31.783333333333335,
        32.75,
        33.7,
        34.65,
        35.61666666666667,
        36.56666666666667,
        37.53333333333333,
        38.483333333333334,
        39.45,
        40.4,
        41.36666666666667,
        42.31666666666667,
        43.28333333333333,
        44.25,
        45.21666666666667,
        46.166666666666664,
        47.13333333333333,
        48.1,
        49.06666666666667,
        50.03333333333333,
        51.0,
        51.96666666666667,
        52.93333333333333,
        53.9,
        54.86666666666667,
        55.85,
        56.81666666666667,
        57.78333333333333,
        58.75,
        59.733333333333334,
        60.7,
        61.666666666666664,
        62.65,
        63.63333333333333,
        64.6,
        65.58333333333333,
        66.55,
        67.53333333333333,
        68.51666666666667,
        69.51666666666667,
        70.5,
        71.48333333333333,
        72.48333333333333,
        73.46666666666667,
        74.46666666666667,
        76.56666666666666,
        77.55,
        78.53333333333333,
        79.51666666666667,
        80.5,
        81.48333333333333,
        82.46666666666667,
        83.45,
        84.43333333333334,
        85.41666666666667,
        86.41666666666667,
        87.4,
        88.38333333333334,
        89.38333333333334,
        90.36666666666666,
        91.36666666666666,
        92.96666666666667,
        93.96666666666667,
        94.95,
        95.95,
        96.95,
        97.95,
        98.95,
        99.95,
        100.96666666666667,
        101.96666666666667,
        102.96666666666667,
        103.98333333333333,
        104.98333333333333,
        106.0,
        107.01666666666667,
        108.01666666666667,
        109.03333333333333,
        110.03333333333333,
        111.05,
        112.06666666666666,
        113.06666666666666,
        114.08333333333333,
        115.1,
        116.11666666666666,
        117.11666666666666,
        118.15,
        138.96666666666667,
        139.98333333333332,
        141.01666666666668,
        142.03333333333333,
        143.05,
        144.06666666666666,
        145.1,
        146.11666666666667,
        147.15,
        148.18333333333334,
        149.21666666666667,
        150.23333333333332,
        151.25,
        152.28333333333333,
        153.3,
        154.33333333333334,
        155.35,
        156.38333333333333,
        157.4,
        158.43333333333334,
        159.46666666666667,
        160.48333333333332,
        161.51666666666668,
        162.55,
        163.58333333333334,
        165.81666666666666,
        166.85,
        167.9,
        168.93333333333334,
        169.96666666666667,
        171.0,
        172.05,
        173.1,
        174.13333333333333,
        175.18333333333334,
        176.21666666666667,
        177.26666666666668,
        178.3,
        179.36666666666667,
        180.43333333333334,
        181.51666666666668,
        182.58333333333334,
        183.65,
        184.73333333333332,
        185.8,
        186.88333333333333,
        187.95,
        189.03333333333333,
        190.11666666666667,
        191.18333333333334,
        192.26666666666668,
        193.35,
        194.43333333333334,
        195.51666666666668,
        196.58333333333334,
        197.66666666666666,
        198.75,
        199.83333333333334,
        200.91666666666666,
        202.0,
        203.1,
        204.18333333333334,
        205.26666666666668,
        206.35,
        207.43333333333334,
        208.53333333333333,
        209.61666666666667,
        210.7,
        211.8,
        234.33333333333334,
        235.43333333333334,
        236.55,
        237.66666666666666,
        238.78333333333333,
        239.91666666666666,
        241.03333333333333,
        242.16666666666666,
        243.28333333333333,
        244.4,
        245.51666666666668,
        246.63333333333333,
        247.75,
        248.86666666666667,
        249.98333333333332,
        251.11666666666667,
        259.1666666666667,
        260.3,
        261.45,
        262.5833333333333,
        263.71666666666664,
        264.85,
        266.0,
        267.1333333333333,
        268.28333333333336,
        270.1,
        271.23333333333335,
        272.3666666666667,
        273.5,
        274.6333333333333,
        275.76666666666665,
        276.9,
        278.03333333333336,
        279.1666666666667,
        280.31666666666666,
        281.45,
        282.5833333333333,
        283.73333333333335,
        284.8666666666667,
        286.0,
        287.15,
        288.28333333333336,
        289.43333333333334,
        290.56666666666666,
        291.71666666666664,
        292.8666666666667,
        294.0,
        295.15,
        296.3,
        297.43333333333334,
        298.5833333333333,
        299.73333333333335,
        300.8833333333333,
        302.03333333333336,
        303.18333333333334,
        304.3333333333333,
        305.48333333333335,
        306.6333333333333,
        307.78333333333336,
        308.95,
        310.1333333333333,
        311.31666666666666,
        312.48333333333335,
        313.6333333333333,
        314.8,
        315.96666666666664,
        317.1166666666667,
        318.28333333333336,
        338.8,
        342.53333333333336,
        343.46666666666664,
        344.4,
        345.3333333333333,
        346.26666666666665,
        347.2,
        348.1333333333333,
        349.0833333333333,
        350.01666666666665,
        350.95,
        351.9,
        352.8333333333333,
        353.76666666666665,
        354.71666666666664,
        355.65,
        356.6,
        357.55,
        358.48333333333335,
        359.43333333333334,
        360.3666666666667,
        361.31666666666666,
        362.26666666666665,
        363.21666666666664,
        364.1666666666667,
        365.1,
        366.05,
        367.0,
        367.95,
        402.85,
        403.81666666666666,
        404.8,
        405.78333333333336,
        406.76666666666665,
        407.73333333333335,
        408.71666666666664,
        409.7,
        410.68333333333334,
        426.8833333333333,
        427.8666666666667,
        428.8666666666667
      ],
      "oxygen": [
        -5.099999904632568,
        -4.400000095367432,
        -4.25,
        34.599998474121094,
        12.449999809265137,
        5.400000095367432,
        2.9000000953674316,
        0.15000000596046448,
        -0.25,
        -2.450000047683716,
        -4.400000095367432,
        -4.75,
        -4.400000095367432,
        -5.099999904632568,
        -4.349999904632568,
        -4.5,
        -4.5,
        -5.099999904632568,
        -5.199999809265137,
        -5.0,
        -4.849999904632568,
        -5.0,
        -4.349999904632568,
        -4.650000095367432,
        -5.25,
        -4.849999904632568,
        -4.949999809265137,
        -4.25,
        -5.25,
        -4.599999904632568,
        -5.150000095367432,
        -4.5,
        -4.25,
        -4.300000190734863,
        -5.25,
        -5.099999904632568,
        -4.050000190734863,
        -5.150000095367432,
        -5.099999904632568,
        -5.050000190734863,
        -4.650000095367432,
        -4.150000095367432,
        -4.550000190734863,
        -5.25,
        -5.5,
        -5.150000095367432,
        -4.5,
        -5.900000095367432,
        -5.150000095367432,
        -5.099999904632568,
        -5.300000190734863,
        -5.099999904632568,
        -5.199999809265137,
        -5.300000190734863,
        -4.599999904632568,
        -4.550000190734863,
        -4.849999904632568,
        -5.5,
        -4.150000095367432,
        -4.949999809265137,
        -5.449999809265137,
        -4.900000095367432,
        -5.300000190734863,
        -5.25,
        -4.099999904632568,
        -5.449999809265137,
        -5.449999809265137,
        -4.449999809265137,
        -5.800000190734863,
        -5.150000095367432,
        -5.349999904632568,
        -4.449999809265137,
        -4.849999904632568,
        -6.0,
        -4.699999809265137,
        -4.900000095367432,
        -4.449999809265137,
        -4.050000190734863,
        26.049999237060547,
        3.6500000953674316,
        -2.3499999046325684,
        -4.550000190734863,
        -4.0,
        -3.950000047683716,
        -4.550000190734863,
        -4.900000095367432,
        -4.0,
        -3.5999999046325684,
        -5.050000190734863,
        -4.800000190734863,
        -5.050000190734863,
        -3.75,
        -4.349999904632568,
        -4.050000190734863,
        -3.6500000953674316,
        -4.150000095367432,
        -4.849999904632568,
        -3.6500000953674316,
        -3.200000047683716,
        -2.549999952316284,
        -4.0,
        -3.0999999046325684,
        -3.5,
        -3.450000047683716,
        -4.699999809265137,
        -3.25,
        -4.25,
        -4.199999809265137,
        -4.349999904632568,
        -4.900000095367432,
        -5.099999904632568,
        -4.349999904632568,
        -4.300000190734863,
        -5.300000190734863,
        -4.5,
        -4.25,
        -4.699999809265137,
        -5.099999904632568,
        -4.800000190734863,
        -5.300000190734863,
        -3.25,
        -5.099999904632568,
        -4.0,
        -5.400000095367432,
        -4.150000095367432,
        -5.400000095367432,
        -3.5999999046325684,
        -4.5,
        -3.549999952316284,
        28.799999237060547,
        12.050000190734863,
        4.400000095367432,
        0.6499999761581421,
        -0.8500000238418579,
        -4.0,
        -4.449999809265137,
        -4.0,
        -4.0,
        -3.75,
        -3.5999999046325684,
        -4.150000095367432,
        -5.300000190734863,
        -4.650000095367432,
        -5.050000190734863,
        -4.949999809265137,
        -4.599999904632568,
        -4.349999904632568,
        -5.25,
        -5.349999904632568,
        -4.150000095367432,
        -3.9000000953674316,
        -5.400000095367432,
        -5.5,
        -3.5,
        -4.300000190734863,
        -5.400000095367432,
        -5.0,
        -4.599999904632568,
        -3.0999999046325684,
        -4.800000190734863,
        -6.0,
        -4.150000095367432,
        -4.449999809265137,
        -4.349999904632568,
        -5.300000190734863,
        -4.599999904632568,
        -5.900000095367432,
        -5.050000190734863,
        -4.400000095367432,
        -5.25,
        -6.300000190734863,
        -4.300000190734863,
        -2.8499999046325684,
        -5.599999904632568,
        -5.050000190734863,
        -4.949999809265137,
        -4.949999809265137,
        -3.950000047683716,
        -4.400000095367432,
        -4.699999809265137,
        -5.849999904632568,
        -4.300000190734863,
        -4.449999809265137,
        -5.199999809265137,
        -4.400000095367432,
        -4.349999904632568,
        -5.900000095367432,
        -4.0,
        -4.849999904632568,
        -4.849999904632568,
        -4.949999809265137,
        -4.650000095367432,
        -5.400000095367432,
        -5.150000095367432,
        -4.449999809265137,
        -5.349999904632568,
        -5.599999904632568,
        -5.949999809265137,
        12.649999618530273,
        -0.6499999761581421,
        -5.449999809265137,
        -4.300000190734863,
        -3.0999999046325684,
        -4.25,
        -4.949999809265137,
        -5.449999809265137,
        -4.650000095367432,
        -3.8499999046325684,
        -4.0,
        -3.950000047683716,
        -5.0,
        -3.799999952316284,
        -4.650000095367432,
        -0.699999988079071,
        -3.200000047683716,
        -0.8999999761581421,
        -3.25,
        -0.6499999761581421,
        -3.0,
        -2.9000000953674316,
        -3.049999952316284,
        -2.9000000953674316,
        -5.349999904632568,
        -2.9000000953674316,
        -2.25,
        -1.25,
        -3.200000047683716,
        -3.3499999046325684,
        -5.25,
        -3.8499999046325684,
        -3.6500000953674316,
        -3.4000000953674316,
        -2.75,
        -4.449999809265137,
        -3.049999952316284,
        -3.0,
        -3.4000000953674316,
        -5.599999904632568,
        -4.400000095367432,
        -4.099999904632568,
        -4.449999809265137,
        10.0,
        -7.25,
        -7.650000095367432,
        -7.150000095367432,
        -3.450000047683716,
        -4.25,
        -2.8499999046325684,
        -5.150000095367432,
        -5.75,
        -4.849999904632568,
        -3.299999952316284,
        -2.299999952316284,
        -2.5,
        -3.549999952316284,
        -4.449999809265137,
        -5.0,
        -5.900000095367432,
        -6.5,
        -5.599999904632568,
        -7.0,
        -3.8499999046325684,
        -2.700000047683716,
        -5.199999809265137,
        -5.400000095367432,
        -4.599999904632568,
        -5.449999809265137,
        -1.4500000476837158,
        -6.099999904632568,
        -8.199999809265137,
        -7.949999809265137,
        -5.849999904632568,
        -5.650000095367432,
        -8.800000190734863,
        -3.3499999046325684,
        -5.699999809265137,
        -7.25,
        -7.150000095367432,
        -4.199999809265137,
        -3.950000047683716,
        -5.150000095367432,
        -5.150000095367432
      ],
      "timestamps": [
        "2024-05-09 18:08:00+03:00",
        "2024-05-09 21:44:00+03:00",
        "2024-05-09 22:40:00+03:00",
        "2024-05-10 00:11:00+03:00",
        "2024-05-10 01:07:00+03:00",
        "2024-05-10 02:03:00+03:00",
        "2024-05-10 02:59:00+03:00",
        "2024-05-10 03:55:00+03:00",
        "2024-05-10 04:51:00+03:00",
        "2024-05-10 05:47:00+03:00",
        "2024-05-10 18:59:00+03:00",
        "2024-05-10 19:56:00+03:00",
        "2024-05-10 20:53:00+03:00",
        "2024-05-10 21:51:00+03:00",
        "2024-05-10 22:48:00+03:00",
        "2024-05-10 23:45:00+03:00",
        "2024-05-11 00:42:00+03:00",
        "2024-05-11 01:39:00+03:00",
        "2024-05-11 02:37:00+03:00",
        "2024-05-11 03:34:00+03:00",
        "2024-05-11 04:31:00+03:00",
        "2024-05-11 05:29:00+03:00",
        "2024-05-11 06:26:00+03:00",
        "2024-05-11 07:24:00+03:00",
        "2024-05-11 08:21:00+03:00",
        "2024-05-11 09:19:00+03:00",
        "2024-05-11 10:16:00+03:00",
        "2024-05-11 11:14:00+03:00",
        "2024-05-11 12:11:00+03:00",
        "2024-05-11 13:09:00+03:00",
        "2024-05-11 14:07:00+03:00",
        "2024-05-11 15:05:00+03:00",
        "2024-05-11 16:02:00+03:00",
        "2024-05-11 17:00:00+03:00",
        "2024-05-11 17:58:00+03:00",
        "2024-05-11 18:56:00+03:00",
        "2024-05-11 19:54:00+03:00",
        "2024-05-11 20:52:00+03:00",
        "2024-05-11 21:50:00+03:00",
        "2024-05-11 22:48:00+03:00",
        "2024-05-11 23:46:00+03:00",
        "2024-05-12 00:44:00+03:00",
        "2024-05-12 01:43:00+03:00",
        "2024-05-12 02:41:00+03:00",
        "2024-05-12 03:39:00+03:00",
        "2024-05-12 04:37:00+03:00",
        "2024-05-12 05:36:00+03:00",
        "2024-05-12 06:34:00+03:00",
        "2024-05-12 07:32:00+03:00",
        "2024-05-12 08:31:00+03:00",
        "2024-05-12 09:30:00+03:00",
        "2024-05-12 10:28:00+03:00",
        "2024-05-12 11:27:00+03:00",
        "2024-05-12 12:25:00+03:00",
        "2024-05-12 13:24:00+03:00",
        "2024-05-12 14:23:00+03:00",
        "2024-05-12 15:23:00+03:00",
        "2024-05-12 16:22:00+03:00",
        "2024-05-12 17:21:00+03:00",
        "2024-05-12 18:21:00+03:00",
        "2024-05-12 19:20:00+03:00",
        "2024-05-12 20:20:00+03:00",
        "2024-05-12 22:26:00+03:00",
        "2024-05-12 23:25:00+03:00",
        "2024-05-13 00:24:00+03:00",
        "2024-05-13 01:23:00+03:00",
        "2024-05-13 02:22:00+03:00",
        "2024-05-13 03:21:00+03:00",
        "2024-05-13 04:20:00+03:00",
        "2024-05-13 05:19:00+03:00",
        "2024-05-13 06:18:00+03:00",
        "2024-05-13 07:17:00+03:00",
        "2024-05-13 08:17:00+03:00",
        "2024-05-13 09:16:00+03:00",
        "2024-05-13 10:15:00+03:00",
        "2024-05-13 11:15:00+03:00",
        "2024-05-13 12:14:00+03:00",
        "2024-05-13 13:14:00+03:00",
        "2024-05-13 14:50:00+03:00",
        "2024-05-13 15:50:00+03:00",
        "2024-05-13 16:49:00+03:00",
        "2024-05-13 17:49:00+03:00",
        "2024-05-13 18:49:00+03:00",
        "2024-05-13 19:49:00+03:00",
        "2024-05-13 20:49:00+03:00",
        "2024-05-13 21:49:00+03:00",
        "2024-05-13 22:50:00+03:00",
        "2024-05-13 23:50:00+03:00",
        "2024-05-14 00:50:00+03:00",
        "2024-05-14 01:51:00+03:00",
        "2024-05-14 02:51:00+03:00",
        "2024-05-14 03:52:00+03:00",
        "2024-05-14 04:53:00+03:00",
        "2024-05-14 05:53:00+03:00",
        "2024-05-14 06:54:00+03:00",
        "2024-05-14 07:54:00+03:00",
        "2024-05-14 08:55:00+03:00",
        "2024-05-14 09:56:00+03:00",
        "2024-05-14 10:56:00+03:00",
        "2024-05-14 11:57:00+03:00",
        "2024-05-14 12:58:00+03:00",
        "2024-05-14 13:59:00+03:00",
        "2024-05-14 14:59:00+03:00",
        "2024-05-14 16:01:00+03:00",
        "2024-05-15 12:50:00+03:00",
        "2024-05-15 13:51:00+03:00",
        "2024-05-15 14:53:00+03:00",
        "2024-05-15 15:54:00+03:00",
        "2024-05-15 16:55:00+03:00",
        "2024-05-15 17:56:00+03:00",
        "2024-05-15 18:58:00+03:00",
        "2024-05-15 19:59:00+03:00",
        "2024-05-15 21:01:00+03:00",
        "2024-05-15 22:03:00+03:00",
        "2024-05-15 23:05:00+03:00",
        "2024-05-16 00:06:00+03:00",
        "2024-05-16 01:07:00+03:00",
        "2024-05-16 02:09:00+03:00",
        "2024-05-16 03:10:00+03:00",
        "2024-05-16 04:12:00+03:00",
        "2024-05-16 05:13:00+03:00",
        "2024-05-16 06:15:00+03:00",
        "2024-05-16 07:16:00+03:00",
        "2024-05-16 08:18:00+03:00",
        "2024-05-16 09:20:00+03:00",
        "2024-05-16 10:21:00+03:00",
        "2024-05-16 11:23:00+03:00",
        "2024-05-16 12:25:00+03:00",
        "2024-05-16 13:27:00+03:00",
        "2024-05-16 15:41:00+03:00",
        "2024-05-16 16:43:00+03:00",
        "2024-05-16 17:46:00+03:00",
        "2024-05-16 18:48:00+03:00",
        "2024-05-16 19:50:00+03:00",
        "2024-05-16 20:52:00+03:00",
        "2024-05-16 21:55:00+03:00",
        "2024-05-16 22:58:00+03:00",
        "2024-05-17 00:00:00+03:00",
        "2024-05-17 01:03:00+03:00",
        "2024-05-17 02:05:00+03:00",
        "2024-05-17 03:08:00+03:00",
        "2024-05-17 04:10:00+03:00",
        "2024-05-17 05:14:00+03:00",
        "2024-05-17 06:18:00+03:00",
        "2024-05-17 07:23:00+03:00",
        "2024-05-17 08:27:00+03:00",
        "2024-05-17 09:31:00+03:00",
        "2024-05-17 10:36:00+03:00",
        "2024-05-17 11:40:00+03:00",
        "2024-05-17 12:45:00+03:00",
        "2024-05-17 13:49:00+03:00",
        "2024-05-17 14:54:00+03:00",
        "2024-05-17 15:59:00+03:00",
        "2024-05-17 17:03:00+03:00",
        "2024-05-17 18:08:00+03:00",
        "2024-05-17 19:13:00+03:00",
        "2024-05-17 20:18:00+03:00",
        "2024-05-17 21:23:00+03:00",
        "2024-05-17 22:27:00+03:00",
        "2024-05-17 23:32:00+03:00",
        "2024-05-18 00:37:00+03:00",
        "2024-05-18 01:42:00+03:00",
        "2024-05-18 02:47:00+03:00",
        "2024-05-18 03:52:00+03:00",
        "2024-05-18 04:58:00+03:00",
        "2024-05-18 06:03:00+03:00",
        "2024-05-18 07:08:00+03:00",
        "2024-05-18 08:13:00+03:00",
        "2024-05-18 09:18:00+03:00",
        "2024-05-18 10:24:00+03:00",
        "2024-05-18 11:29:00+03:00",
        "2024-05-18 12:34:00+03:00",
        "2024-05-18 13:40:00+03:00",
        "2024-05-19 12:12:00+03:00",
        "2024-05-19 13:18:00+03:00",
        "2024-05-19 14:25:00+03:00",
        "2024-05-19 15:32:00+03:00",
        "2024-05-19 16:39:00+03:00",
        "2024-05-19 17:47:00+03:00",
        "2024-05-19 18:54:00+03:00",
        "2024-05-19 20:02:00+03:00",
        "2024-05-19 21:09:00+03:00",
        "2024-05-19 22:16:00+03:00",
        "2024-05-19 23:23:00+03:00",
        "2024-05-20 00:30:00+03:00",
        "2024-05-20 01:37:00+03:00",
        "2024-05-20 02:44:00+03:00",
        "2024-05-20 03:51:00+03:00",
        "2024-05-20 04:59:00+03:00",
        "2024-05-20 13:02:00+03:00",
        "2024-05-20 14:10:00+03:00",
        "2024-05-20 15:19:00+03:00",
        "2024-05-20 16:27:00+03:00",
        "2024-05-20 17:35:00+03:00",
        "2024-05-20 18:43:00+03:00",
        "2024-05-20 19:52:00+03:00",
        "2024-05-20 21:00:00+03:00",
        "2024-05-20 22:09:00+03:00",
        "2024-05-20 23:58:00+03:00",
        "2024-05-21 01:06:00+03:00",
        "2024-05-21 02:14:00+03:00",
        "2024-05-21 03:22:00+03:00",
        "2024-05-21 04:30:00+03:00",
        "2024-05-21 05:38:00+03:00",
        "2024-05-21 06:46:00+03:00",
        "2024-05-21 07:54:00+03:00",
        "2024-05-21 09:02:00+03:00",
        "2024-05-21 10:11:00+03:00",
        "2024-05-21 11:19:00+03:00",
        "2024-05-21 12:27:00+03:00",
        "2024-05-21 13:36:00+03:00",
        "2024-05-21 14:44:00+03:00",
        "2024-05-21 15:52:00+03:00",
        "2024-05-21 17:01:00+03:00",
        "2024-05-21 18:09:00+03:00",
        "2024-05-21 19:18:00+03:00",
        "2024-05-21 20:26:00+03:00",
        "2024-05-21 21:35:00+03:00",
        "2024-05-21 22:44:00+03:00",
        "2024-05-21 23:52:00+03:00",
        "2024-05-22 01:01:00+03:00",
        "2024-05-22 02:10:00+03:00",
        "2024-05-22 03:18:00+03:00",
        "2024-05-22 04:27:00+03:00",
        "2024-05-22 05:36:00+03:00",
        "2024-05-22 06:45:00+03:00",
        "2024-05-22 07:54:00+03:00",
        "2024-05-22 09:03:00+03:00",
        "2024-05-22 10:12:00+03:00",
        "2024-05-22 11:21:00+03:00",
        "2024-05-22 12:30:00+03:00",
        "2024-05-22 13:39:00+03:00",
        "2024-05-22 14:49:00+03:00",
        "2024-05-22 16:00:00+03:00",
        "2024-05-22 17:11:00+03:00",
        "2024-05-22 18:21:00+03:00",
        "2024-05-22 19:30:00+03:00",
        "2024-05-22 20:40:00+03:00",
        "2024-05-22 21:50:00+03:00",
        "2024-05-22 22:59:00+03:00",
        "2024-05-23 00:09:00+03:00",
        "2024-05-23 20:40:00+03:00",
        "2024-05-24 00:24:00+03:00",
        "2024-05-24 01:20:00+03:00",
        "2024-05-24 02:16:00+03:00",
        "2024-05-24 03:12:00+03:00",
        "2024-05-24 04:08:00+03:00",
        "2024-05-24 05:04:00+03:00",
        "2024-05-24 06:00:00+03:00",
        "2024-05-24 06:57:00+03:00",
        "2024-05-24 07:53:00+03:00",
        "2024-05-24 08:49:00+03:00",
        "2024-05-24 09:46:00+03:00",
        "2024-05-24 10:42:00+03:00",
        "2024-05-24 11:38:00+03:00",
        "2024-05-24 12:35:00+03:00",
        "2024-05-24 13:31:00+03:00",
        "2024-05-24 14:28:00+03:00",
        "2024-05-24 15:25:00+03:00",
        "2024-05-24 16:21:00+03:00",
        "2024-05-24 17:18:00+03:00",
        "2024-05-24 18:14:00+03:00",
        "2024-05-24 19:11:00+03:00",
        "2024-05-24 20:08:00+03:00",
        "2024-05-24 21:05:00+03:00",
        "2024-05-24 22:02:00+03:00",
        "2024-05-24 22:58:00+03:00",
        "2024-05-24 23:55:00+03:00",
        "2024-05-25 00:52:00+03:00",
        "2024-05-25 01:49:00+03:00",
        "2024-05-26 12:43:00+03:00",
        "2024-05-26 13:41:00+03:00",
        "2024-05-26 14:40:00+03:00",
        "2024-05-26 15:39:00+03:00",
        "2024-05-26 16:38:00+03:00",
        "2024-05-26 17:36:00+03:00",
        "2024-05-26 18:35:00+03:00",
        "2024-05-26 19:34:00+03:00",
        "2024-05-26 20:33:00+03:00",
        "2024-05-27 12:45:00+03:00",
        "2024-05-27 13:44:00+03:00",
        "2024-05-27 14:44:00+03:00"
      ]
    },
    "period_boundaries": [
      {
        "start": 2.623170277777778,
        "end": 162.36211694444447,
        "period_number": 2,
        "duration": 159.7389466666667,
        "data_points": 126
      },
      {
        "start": 162.36211694444447,
        "end": 265.90432805555554,
        "period_number": 3,
        "duration": 103.54221111111107,
        "data_points": 68
      },
      {
        "start": 265.90432805555554,
        "end": 334.0,
        "period_number": 4,
        "duration": 68.09567194444446,
        "data_points": 46
      },
      {
        "start": 334.0,
        "end": 428.8666666666667,
        "period_number": 5,
        "duration": 94.86666666666667,
        "data_points": 40
      }
    ],
    "media_change_events": [
      2.623170277777778,
      162.36211694444447,
      265.90432805555554,
      334.0
    ],
    "data_range": {
      "time_min": 0.26666666666666666,
      "time_max": 428.8666666666667,
      "oxygen_min": -8.800000190734863,
      "oxygen_max": 34.599998474121094
    }
  },
  {
    "well_id": "06e6ebb9-f553-48e8-a894-c3d02328f599_145",
    "plate_id": "06e6ebb9-f553-48e8-a894-c3d02328f599",
    "drug": "Sunitinib",
    "concentration": 0.28,
    "time_series": {
      "time": [
        3.533333333333333,
        3.9833333333333334,
        4.916666666666667,
        6.433333333333334,
        7.366666666666666,
        8.3,
        9.233333333333333,
        10.166666666666666,
        11.1,
        12.033333333333333,
        25.25,
        26.2,
        27.15,
        28.1,
        29.05,
        30.0,
        30.95,
        31.9,
        32.86666666666667,
        33.81666666666667,
        34.766666666666666,
        35.733333333333334,
        36.68333333333333,
        37.65,
        38.6,
        39.56666666666667,
        40.516666666666666,
        41.483333333333334,
        42.45,
        43.4,
        44.36666666666667,
        45.333333333333336,
        46.3,
        47.266666666666666,
        48.21666666666667,
        49.18333333333333,
        50.15,
        51.11666666666667,
        52.083333333333336,
        53.05,
        54.016666666666666,
        55.0,
        55.96666666666667,
        56.93333333333333,
        57.9,
        58.88333333333333,
        59.85,
        60.81666666666667,
        61.8,
        62.766666666666666,
        63.75,
        64.71666666666667,
        65.7,
        66.68333333333334,
        67.66666666666667,
        68.65,
        69.63333333333334,
        70.61666666666666,
        71.61666666666666,
        72.6,
        73.6,
        74.58333333333333,
        76.68333333333334,
        77.66666666666667,
        78.65,
        79.63333333333334,
        80.61666666666666,
        81.6,
        82.58333333333333,
        83.56666666666666,
        84.56666666666666,
        85.55,
        86.53333333333333,
        87.51666666666667,
        88.51666666666667,
        89.5,
        90.5,
        91.5,
        93.1,
        94.08333333333333,
        95.08333333333333,
        96.06666666666666,
        97.06666666666666,
        98.06666666666666,
        99.08333333333333,
        100.08333333333333,
        101.08333333333333,
        102.1,
        103.1,
        104.1,
        105.11666666666666,
        106.11666666666666,
        107.13333333333334,
        108.15,
        109.15,
        110.16666666666667,
        111.16666666666667,
        112.18333333333334,
        113.2,
        114.21666666666667,
        115.21666666666667,
        116.23333333333333,
        117.25,
        118.26666666666667,
        139.1,
        140.11666666666667,
        141.13333333333333,
        142.16666666666666,
        143.18333333333334,
        144.2,
        145.21666666666667,
        146.25,
        147.28333333333333,
        148.31666666666666,
        149.33333333333334,
        150.36666666666667,
        151.38333333333333,
        152.4,
        153.43333333333334,
        154.45,
        155.48333333333332,
        156.5,
        157.53333333333333,
        158.56666666666666,
        159.58333333333334,
        160.61666666666667,
        161.65,
        162.68333333333334,
        163.71666666666667,
        165.95,
        166.98333333333332,
        168.01666666666668,
        169.06666666666666,
        170.1,
        171.13333333333333,
        172.18333333333334,
        173.23333333333332,
        174.26666666666668,
        175.3,
        176.35,
        177.38333333333333,
        178.43333333333334,
        179.5,
        180.56666666666666,
        181.65,
        182.71666666666667,
        183.78333333333333,
        184.86666666666667,
        185.93333333333334,
        187.01666666666668,
        188.08333333333334,
        189.16666666666666,
        190.25,
        191.31666666666666,
        192.4,
        193.48333333333332,
        194.56666666666666,
        195.65,
        196.73333333333332,
        197.8,
        198.88333333333333,
        199.96666666666667,
        201.05,
        202.15,
        203.23333333333332,
        204.31666666666666,
        205.4,
        206.48333333333332,
        207.58333333333334,
        208.66666666666666,
        209.75,
        210.85,
        211.93333333333334,
        234.46666666666667,
        235.56666666666666,
        236.68333333333334,
        237.8,
        238.93333333333334,
        240.05,
        241.18333333333334,
        242.3,
        243.41666666666666,
        244.53333333333333,
        245.65,
        246.76666666666668,
        247.88333333333333,
        249.0,
        250.13333333333333,
        251.25,
        258.18333333333334,
        259.31666666666666,
        260.45,
        261.5833333333333,
        262.71666666666664,
        263.8666666666667,
        265.0,
        266.1333333333333,
        267.28333333333336,
        268.4166666666667,
        270.25,
        271.3833333333333,
        272.5,
        273.6333333333333,
        274.76666666666665,
        275.9,
        277.05,
        278.18333333333334,
        279.31666666666666,
        280.45,
        281.5833333333333,
        282.73333333333335,
        283.8666666666667,
        285.01666666666665,
        286.15,
        287.28333333333336,
        288.43333333333334,
        289.56666666666666,
        290.71666666666664,
        291.85,
        293.0,
        294.15,
        295.28333333333336,
        296.43333333333334,
        297.5833333333333,
        298.73333333333335,
        299.8833333333333,
        301.01666666666665,
        302.1666666666667,
        303.31666666666666,
        304.46666666666664,
        305.6166666666667,
        306.78333333333336,
        307.93333333333334,
        309.1,
        310.28333333333336,
        311.46666666666664,
        312.6333333333333,
        313.78333333333336,
        314.95,
        316.1,
        317.26666666666665,
        338.9166666666667,
        342.65,
        343.5833333333333,
        344.51666666666665,
        345.45,
        346.3833333333333,
        347.31666666666666,
        348.25,
        349.2,
        350.1333333333333,
        351.06666666666666,
        352.01666666666665,
        352.95,
        353.8833333333333,
        354.8333333333333,
        355.76666666666665,
        356.71666666666664,
        357.6666666666667,
        358.6,
        359.55,
        360.48333333333335,
        361.43333333333334,
        362.3833333333333,
        363.3333333333333,
        364.28333333333336,
        365.23333333333335,
        366.1666666666667,
        367.1166666666667,
        368.06666666666666,
        402.96666666666664,
        403.95,
        404.9166666666667,
        405.9,
        406.8833333333333,
        407.8666666666667,
        408.85,
        409.81666666666666,
        410.81666666666666,
        427.0,
        428.0,
        429.0
      ],
      "oxygen": [
        -4.849999904632568,
        -4.5,
        -5.0,
        37.650001525878906,
        20.049999237060547,
        3.200000047683716,
        1.850000023841858,
        -0.05000000074505806,
        -2.75,
        -3.3499999046325684,
        -4.650000095367432,
        -4.050000190734863,
        -4.550000190734863,
        -4.099999904632568,
        -4.25,
        -4.0,
        -4.349999904632568,
        -4.75,
        -4.599999904632568,
        -4.650000095367432,
        -4.5,
        -4.25,
        -5.199999809265137,
        -4.75,
        -4.25,
        -4.650000095367432,
        -4.75,
        -4.75,
        -4.199999809265137,
        -4.699999809265137,
        -4.800000190734863,
        -4.650000095367432,
        -4.550000190734863,
        -4.849999904632568,
        -4.849999904632568,
        -4.599999904632568,
        -5.25,
        -5.199999809265137,
        -4.550000190734863,
        -5.0,
        -4.949999809265137,
        -4.650000095367432,
        -5.150000095367432,
        -5.0,
        -5.099999904632568,
        -4.949999809265137,
        -4.599999904632568,
        -4.949999809265137,
        -5.199999809265137,
        -5.099999904632568,
        -4.699999809265137,
        -5.150000095367432,
        -5.199999809265137,
        -4.849999904632568,
        -5.099999904632568,
        -4.650000095367432,
        -4.75,
        -5.199999809265137,
        -5.349999904632568,
        -4.900000095367432,
        -4.849999904632568,
        -4.800000190734863,
        -4.650000095367432,
        -5.099999904632568,
        -4.800000190734863,
        -5.199999809265137,
        -4.5,
        -4.300000190734863,
        -4.849999904632568,
        -4.75,
        -5.300000190734863,
        -5.349999904632568,
        -5.449999809265137,
        -5.099999904632568,
        -4.849999904632568,
        -5.050000190734863,
        -5.099999904632568,
        -5.349999904632568,
        28.600000381469727,
        5.849999904632568,
        -3.0,
        -4.849999904632568,
        -4.75,
        -4.949999809265137,
        -4.849999904632568,
        -4.949999809265137,
        -5.0,
        -4.599999904632568,
        -5.199999809265137,
        -5.199999809265137,
        -4.849999904632568,
        -5.099999904632568,
        -4.25,
        -4.5,
        -4.300000190734863,
        -2.0999999046325684,
        -4.300000190734863,
        -2.049999952316284,
        0.75,
        0.8999999761581421,
        0.05000000074505806,
        -1.100000023841858,
        -2.549999952316284,
        -4.150000095367432,
        -4.800000190734863,
        -4.900000095367432,
        -4.75,
        -4.75,
        -5.25,
        -5.400000095367432,
        -4.400000095367432,
        -4.699999809265137,
        -5.099999904632568,
        -4.800000190734863,
        -4.599999904632568,
        -5.300000190734863,
        -5.150000095367432,
        -5.300000190734863,
        -5.050000190734863,
        -5.300000190734863,
        -4.800000190734863,
        -4.800000190734863,
        -5.199999809265137,
        -4.849999904632568,
        -5.099999904632568,
        -4.699999809265137,
        -5.199999809265137,
        -5.0,
        -4.75,
        28.549999237060547,
        22.5,
        14.800000190734863,
        11.800000190734863,
        9.550000190734863,
        8.0,
        9.300000190734863,
        5.800000190734863,
        3.9000000953674316,
        1.0,
        -0.4000000059604645,
        -1.7999999523162842,
        -2.799999952316284,
        -3.4000000953674316,
        -4.5,
        -4.599999904632568,
        -4.349999904632568,
        -5.199999809265137,
        -4.949999809265137,
        -4.699999809265137,
        -4.699999809265137,
        -5.0,
        -4.849999904632568,
        -5.0,
        -5.150000095367432,
        -5.25,
        -4.550000190734863,
        -4.550000190734863,
        -5.099999904632568,
        -5.050000190734863,
        -4.699999809265137,
        -4.550000190734863,
        -4.75,
        -4.5,
        -4.650000095367432,
        -4.699999809265137,
        -4.650000095367432,
        -4.599999904632568,
        -4.349999904632568,
        -4.150000095367432,
        -5.050000190734863,
        -5.050000190734863,
        -4.800000190734863,
        -4.75,
        -4.849999904632568,
        -3.799999952316284,
        -4.050000190734863,
        -4.900000095367432,
        -5.0,
        -4.75,
        -4.699999809265137,
        -5.349999904632568,
        -4.900000095367432,
        -5.0,
        -5.0,
        -5.199999809265137,
        -5.0,
        -4.949999809265137,
        -5.349999904632568,
        -5.349999904632568,
        -5.050000190734863,
        -4.900000095367432,
        -5.699999809265137,
        -5.25,
        -5.099999904632568,
        -4.800000190734863,
        -5.0,
        -5.150000095367432,
        -4.75,
        -4.150000095367432,
        9.199999809265137,
        -0.8500000238418579,
        -3.799999952316284,
        -3.9000000953674316,
        -3.799999952316284,
        -4.650000095367432,
        -4.300000190734863,
        -4.599999904632568,
        -4.550000190734863,
        -4.099999904632568,
        -4.550000190734863,
        -4.599999904632568,
        -4.599999904632568,
        -4.099999904632568,
        -1.100000023841858,
        -0.4000000059604645,
        -0.6499999761581421,
        -2.450000047683716,
        4.099999904632568,
        7.699999809265137,
        7.400000095367432,
        6.150000095367432,
        6.849999904632568,
        4.75,
        2.75,
        2.75,
        2.5999999046325684,
        2.549999952316284,
        0.3499999940395355,
        1.350000023841858,
        0.25,
        -1.0,
        -1.149999976158142,
        1.350000023841858,
        1.2000000476837158,
        0.25,
        -0.75,
        -0.75,
        -1.25,
        -1.600000023841858,
        -2.549999952316284,
        -2.9000000953674316,
        0.20000000298023224,
        -4.400000095367432,
        -4.949999809265137,
        -4.050000190734863,
        -3.799999952316284,
        -4.199999809265137,
        -2.9000000953674316,
        -2.6500000953674316,
        -2.799999952316284,
        -3.5,
        -4.099999904632568,
        -3.75,
        -4.599999904632568,
        -4.300000190734863,
        -4.199999809265137,
        -4.400000095367432,
        -4.400000095367432,
        -4.650000095367432,
        -4.300000190734863,
        -5.0,
        -5.400000095367432,
        -4.449999809265137,
        -4.400000095367432,
        -4.849999904632568,
        -5.599999904632568,
        -5.550000190734863,
        -5.349999904632568,
        -5.300000190734863,
        -5.699999809265137,
        -4.449999809265137,
        -5.199999809265137,
        -4.599999904632568,
        -5.099999904632568,
        -5.849999904632568,
        -5.650000095367432,
        -4.699999809265137,
        -5.150000095367432,
        -5.599999904632568,
        -4.800000190734863,
        -5.300000190734863,
        -4.900000095367432
      ],
      "timestamps": [
        "2024-05-09 21:24:00+03:00",
        "2024-05-09 21:51:00+03:00",
        "2024-05-09 22:47:00+03:00",
        "2024-05-10 00:18:00+03:00",
        "2024-05-10 01:14:00+03:00",
        "2024-05-10 02:10:00+03:00",
        "2024-05-10 03:06:00+03:00",
        "2024-05-10 04:02:00+03:00",
        "2024-05-10 04:58:00+03:00",
        "2024-05-10 05:54:00+03:00",
        "2024-05-10 19:07:00+03:00",
        "2024-05-10 20:04:00+03:00",
        "2024-05-10 21:01:00+03:00",
        "2024-05-10 21:58:00+03:00",
        "2024-05-10 22:55:00+03:00",
        "2024-05-10 23:52:00+03:00",
        "2024-05-11 00:49:00+03:00",
        "2024-05-11 01:46:00+03:00",
        "2024-05-11 02:44:00+03:00",
        "2024-05-11 03:41:00+03:00",
        "2024-05-11 04:38:00+03:00",
        "2024-05-11 05:36:00+03:00",
        "2024-05-11 06:33:00+03:00",
        "2024-05-11 07:31:00+03:00",
        "2024-05-11 08:28:00+03:00",
        "2024-05-11 09:26:00+03:00",
        "2024-05-11 10:23:00+03:00",
        "2024-05-11 11:21:00+03:00",
        "2024-05-11 12:19:00+03:00",
        "2024-05-11 13:16:00+03:00",
        "2024-05-11 14:14:00+03:00",
        "2024-05-11 15:12:00+03:00",
        "2024-05-11 16:10:00+03:00",
        "2024-05-11 17:08:00+03:00",
        "2024-05-11 18:05:00+03:00",
        "2024-05-11 19:03:00+03:00",
        "2024-05-11 20:01:00+03:00",
        "2024-05-11 20:59:00+03:00",
        "2024-05-11 21:57:00+03:00",
        "2024-05-11 22:55:00+03:00",
        "2024-05-11 23:53:00+03:00",
        "2024-05-12 00:52:00+03:00",
        "2024-05-12 01:50:00+03:00",
        "2024-05-12 02:48:00+03:00",
        "2024-05-12 03:46:00+03:00",
        "2024-05-12 04:45:00+03:00",
        "2024-05-12 05:43:00+03:00",
        "2024-05-12 06:41:00+03:00",
        "2024-05-12 07:40:00+03:00",
        "2024-05-12 08:38:00+03:00",
        "2024-05-12 09:37:00+03:00",
        "2024-05-12 10:35:00+03:00",
        "2024-05-12 11:34:00+03:00",
        "2024-05-12 12:33:00+03:00",
        "2024-05-12 13:32:00+03:00",
        "2024-05-12 14:31:00+03:00",
        "2024-05-12 15:30:00+03:00",
        "2024-05-12 16:29:00+03:00",
        "2024-05-12 17:29:00+03:00",
        "2024-05-12 18:28:00+03:00",
        "2024-05-12 19:28:00+03:00",
        "2024-05-12 20:27:00+03:00",
        "2024-05-12 22:33:00+03:00",
        "2024-05-12 23:32:00+03:00",
        "2024-05-13 00:31:00+03:00",
        "2024-05-13 01:30:00+03:00",
        "2024-05-13 02:29:00+03:00",
        "2024-05-13 03:28:00+03:00",
        "2024-05-13 04:27:00+03:00",
        "2024-05-13 05:26:00+03:00",
        "2024-05-13 06:26:00+03:00",
        "2024-05-13 07:25:00+03:00",
        "2024-05-13 08:24:00+03:00",
        "2024-05-13 09:23:00+03:00",
        "2024-05-13 10:23:00+03:00",
        "2024-05-13 11:22:00+03:00",
        "2024-05-13 12:22:00+03:00",
        "2024-05-13 13:22:00+03:00",
        "2024-05-13 14:58:00+03:00",
        "2024-05-13 15:57:00+03:00",
        "2024-05-13 16:57:00+03:00",
        "2024-05-13 17:56:00+03:00",
        "2024-05-13 18:56:00+03:00",
        "2024-05-13 19:56:00+03:00",
        "2024-05-13 20:57:00+03:00",
        "2024-05-13 21:57:00+03:00",
        "2024-05-13 22:57:00+03:00",
        "2024-05-13 23:58:00+03:00",
        "2024-05-14 00:58:00+03:00",
        "2024-05-14 01:58:00+03:00",
        "2024-05-14 02:59:00+03:00",
        "2024-05-14 03:59:00+03:00",
        "2024-05-14 05:00:00+03:00",
        "2024-05-14 06:01:00+03:00",
        "2024-05-14 07:01:00+03:00",
        "2024-05-14 08:02:00+03:00",
        "2024-05-14 09:02:00+03:00",
        "2024-05-14 10:03:00+03:00",
        "2024-05-14 11:04:00+03:00",
        "2024-05-14 12:05:00+03:00",
        "2024-05-14 13:05:00+03:00",
        "2024-05-14 14:06:00+03:00",
        "2024-05-14 15:07:00+03:00",
        "2024-05-14 16:08:00+03:00",
        "2024-05-15 12:58:00+03:00",
        "2024-05-15 13:59:00+03:00",
        "2024-05-15 15:00:00+03:00",
        "2024-05-15 16:02:00+03:00",
        "2024-05-15 17:03:00+03:00",
        "2024-05-15 18:04:00+03:00",
        "2024-05-15 19:05:00+03:00",
        "2024-05-15 20:07:00+03:00",
        "2024-05-15 21:09:00+03:00",
        "2024-05-15 22:11:00+03:00",
        "2024-05-15 23:12:00+03:00",
        "2024-05-16 00:14:00+03:00",
        "2024-05-16 01:15:00+03:00",
        "2024-05-16 02:16:00+03:00",
        "2024-05-16 03:18:00+03:00",
        "2024-05-16 04:19:00+03:00",
        "2024-05-16 05:21:00+03:00",
        "2024-05-16 06:22:00+03:00",
        "2024-05-16 07:24:00+03:00",
        "2024-05-16 08:26:00+03:00",
        "2024-05-16 09:27:00+03:00",
        "2024-05-16 10:29:00+03:00",
        "2024-05-16 11:31:00+03:00",
        "2024-05-16 12:33:00+03:00",
        "2024-05-16 13:35:00+03:00",
        "2024-05-16 15:49:00+03:00",
        "2024-05-16 16:51:00+03:00",
        "2024-05-16 17:53:00+03:00",
        "2024-05-16 18:56:00+03:00",
        "2024-05-16 19:58:00+03:00",
        "2024-05-16 21:00:00+03:00",
        "2024-05-16 22:03:00+03:00",
        "2024-05-16 23:06:00+03:00",
        "2024-05-17 00:08:00+03:00",
        "2024-05-17 01:10:00+03:00",
        "2024-05-17 02:13:00+03:00",
        "2024-05-17 03:15:00+03:00",
        "2024-05-17 04:18:00+03:00",
        "2024-05-17 05:22:00+03:00",
        "2024-05-17 06:26:00+03:00",
        "2024-05-17 07:31:00+03:00",
        "2024-05-17 08:35:00+03:00",
        "2024-05-17 09:39:00+03:00",
        "2024-05-17 10:44:00+03:00",
        "2024-05-17 11:48:00+03:00",
        "2024-05-17 12:53:00+03:00",
        "2024-05-17 13:57:00+03:00",
        "2024-05-17 15:02:00+03:00",
        "2024-05-17 16:07:00+03:00",
        "2024-05-17 17:11:00+03:00",
        "2024-05-17 18:16:00+03:00",
        "2024-05-17 19:21:00+03:00",
        "2024-05-17 20:26:00+03:00",
        "2024-05-17 21:31:00+03:00",
        "2024-05-17 22:36:00+03:00",
        "2024-05-17 23:40:00+03:00",
        "2024-05-18 00:45:00+03:00",
        "2024-05-18 01:50:00+03:00",
        "2024-05-18 02:55:00+03:00",
        "2024-05-18 04:01:00+03:00",
        "2024-05-18 05:06:00+03:00",
        "2024-05-18 06:11:00+03:00",
        "2024-05-18 07:16:00+03:00",
        "2024-05-18 08:21:00+03:00",
        "2024-05-18 09:27:00+03:00",
        "2024-05-18 10:32:00+03:00",
        "2024-05-18 11:37:00+03:00",
        "2024-05-18 12:43:00+03:00",
        "2024-05-18 13:48:00+03:00",
        "2024-05-19 12:20:00+03:00",
        "2024-05-19 13:26:00+03:00",
        "2024-05-19 14:33:00+03:00",
        "2024-05-19 15:40:00+03:00",
        "2024-05-19 16:48:00+03:00",
        "2024-05-19 17:55:00+03:00",
        "2024-05-19 19:03:00+03:00",
        "2024-05-19 20:10:00+03:00",
        "2024-05-19 21:17:00+03:00",
        "2024-05-19 22:24:00+03:00",
        "2024-05-19 23:31:00+03:00",
        "2024-05-20 00:38:00+03:00",
        "2024-05-20 01:45:00+03:00",
        "2024-05-20 02:52:00+03:00",
        "2024-05-20 04:00:00+03:00",
        "2024-05-20 05:07:00+03:00",
        "2024-05-20 12:03:00+03:00",
        "2024-05-20 13:11:00+03:00",
        "2024-05-20 14:19:00+03:00",
        "2024-05-20 15:27:00+03:00",
        "2024-05-20 16:35:00+03:00",
        "2024-05-20 17:44:00+03:00",
        "2024-05-20 18:52:00+03:00",
        "2024-05-20 20:00:00+03:00",
        "2024-05-20 21:09:00+03:00",
        "2024-05-20 22:17:00+03:00",
        "2024-05-21 00:07:00+03:00",
        "2024-05-21 01:15:00+03:00",
        "2024-05-21 02:22:00+03:00",
        "2024-05-21 03:30:00+03:00",
        "2024-05-21 04:38:00+03:00",
        "2024-05-21 05:46:00+03:00",
        "2024-05-21 06:55:00+03:00",
        "2024-05-21 08:03:00+03:00",
        "2024-05-21 09:11:00+03:00",
        "2024-05-21 10:19:00+03:00",
        "2024-05-21 11:27:00+03:00",
        "2024-05-21 12:36:00+03:00",
        "2024-05-21 13:44:00+03:00",
        "2024-05-21 14:53:00+03:00",
        "2024-05-21 16:01:00+03:00",
        "2024-05-21 17:09:00+03:00",
        "2024-05-21 18:18:00+03:00",
        "2024-05-21 19:26:00+03:00",
        "2024-05-21 20:35:00+03:00",
        "2024-05-21 21:43:00+03:00",
        "2024-05-21 22:52:00+03:00",
        "2024-05-22 00:01:00+03:00",
        "2024-05-22 01:09:00+03:00",
        "2024-05-22 02:18:00+03:00",
        "2024-05-22 03:27:00+03:00",
        "2024-05-22 04:36:00+03:00",
        "2024-05-22 05:45:00+03:00",
        "2024-05-22 06:53:00+03:00",
        "2024-05-22 08:02:00+03:00",
        "2024-05-22 09:11:00+03:00",
        "2024-05-22 10:20:00+03:00",
        "2024-05-22 11:29:00+03:00",
        "2024-05-22 12:39:00+03:00",
        "2024-05-22 13:48:00+03:00",
        "2024-05-22 14:58:00+03:00",
        "2024-05-22 16:09:00+03:00",
        "2024-05-22 17:20:00+03:00",
        "2024-05-22 18:30:00+03:00",
        "2024-05-22 19:39:00+03:00",
        "2024-05-22 20:49:00+03:00",
        "2024-05-22 21:58:00+03:00",
        "2024-05-22 23:08:00+03:00",
        "2024-05-23 20:47:00+03:00",
        "2024-05-24 00:31:00+03:00",
        "2024-05-24 01:27:00+03:00",
        "2024-05-24 02:23:00+03:00",
        "2024-05-24 03:19:00+03:00",
        "2024-05-24 04:15:00+03:00",
        "2024-05-24 05:11:00+03:00",
        "2024-05-24 06:07:00+03:00",
        "2024-05-24 07:04:00+03:00",
        "2024-05-24 08:00:00+03:00",
        "2024-05-24 08:56:00+03:00",
        "2024-05-24 09:53:00+03:00",
        "2024-05-24 10:49:00+03:00",
        "2024-05-24 11:45:00+03:00",
        "2024-05-24 12:42:00+03:00",
        "2024-05-24 13:38:00+03:00",
        "2024-05-24 14:35:00+03:00",
        "2024-05-24 15:32:00+03:00",
        "2024-05-24 16:28:00+03:00",
        "2024-05-24 17:25:00+03:00",
        "2024-05-24 18:21:00+03:00",
        "2024-05-24 19:18:00+03:00",
        "2024-05-24 20:15:00+03:00",
        "2024-05-24 21:12:00+03:00",
        "2024-05-24 22:09:00+03:00",
        "2024-05-24 23:06:00+03:00",
        "2024-05-25 00:02:00+03:00",
        "2024-05-25 00:59:00+03:00",
        "2024-05-25 01:56:00+03:00",
        "2024-05-26 12:50:00+03:00",
        "2024-05-26 13:49:00+03:00",
        "2024-05-26 14:47:00+03:00",
        "2024-05-26 15:46:00+03:00",
        "2024-05-26 16:45:00+03:00",
        "2024-05-26 17:44:00+03:00",
        "2024-05-26 18:43:00+03:00",
        "2024-05-26 19:41:00+03:00",
        "2024-05-26 20:41:00+03:00",
        "2024-05-27 12:52:00+03:00",
        "2024-05-27 13:52:00+03:00",
        "2024-05-27 14:52:00+03:00"
      ]
    },
    "period_boundaries": [
      {
        "start": 3.533333333333333,
        "end": 159.0954502777778,
        "period_number": 1,
        "duration": 155.56211694444445,
        "data_points": 124
      },
      {
        "start": 159.0954502777778,
        "end": 262.6376613888889,
        "period_number": 2,
        "duration": 103.5422111111111,
        "data_points": 69
      },
      {
        "start": 262.6376613888889,
        "end": 330.73333333333335,
        "period_number": 3,
        "duration": 68.09567194444446,
        "data_points": 48
      },
      {
        "start": 330.73333333333335,
        "end": 429.0,
        "period_number": 4,
        "duration": 98.26666666666665,
        "data_points": 40
      }
    ],
    "media_change_events": [
      159.0954502777778,
      262.6376613888889,
      330.73333333333335
    ],
    "data_range": {
      "time_min": 3.533333333333333,
      "time_max": 429.0,
      "oxygen_min": -5.849999904632568,
      "oxygen_max": 37.650001525878906
    }
  }
];
        let currentWell = null;
        let currentPeriods = [];
        let originalPeriods = [];
        let modifications = [];
        let plotlyPlot = null;
        
        // Initialize the application
        function initializeApp() {
            populateWellSelector();
            if (wellsData.length > 0) {
                loadWell(0);
            }
        }
        
        function populateWellSelector() {
            const select = document.getElementById('wellSelect');
            wellsData.forEach((well, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${well.drug} (${well.concentration}ŒºM) - ${well.well_id.substring(0, 8)}...`;
                select.appendChild(option);
            });
        }
        
        function loadWell(index = null) {
            if (index === null) {
                index = parseInt(document.getElementById('wellSelect').value);
            }
            
            if (index === '' || isNaN(index)) return;
            
            currentWell = wellsData[index];
            currentPeriods = JSON.parse(JSON.stringify(currentWell.period_boundaries));
            originalPeriods = JSON.parse(JSON.stringify(currentWell.period_boundaries));
            modifications = [];
            
            document.getElementById('wellSelect').value = index;
            updateWellInfo();
            updatePlot();
            updatePeriodList();
            updateModifications();
            
            document.getElementById('wellInfo').style.display = 'block';
            document.getElementById('periodList').style.display = 'block';
        }
        
        function updateWellInfo() {
            const content = document.getElementById('wellInfoContent');
            const well = currentWell;
            
            content.innerHTML = `
                <div class="info-item">
                    <span class="info-label">Well ID:</span>
                    <span>${well.well_id}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Drug:</span>
                    <span>${well.drug}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Concentration:</span>
                    <span>${well.concentration} ŒºM</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Plate ID:</span>
                    <span>${well.plate_id.substring(0, 8)}...</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Time Range:</span>
                    <span>${well.data_range.time_min.toFixed(1)} - ${well.data_range.time_max.toFixed(1)} hours</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Periods:</span>
                    <span>${currentPeriods.length}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Media Changes:</span>
                    <span>${well.media_change_events.length}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Data Points:</span>
                    <span>${well.time_series.time.length}</span>
                </div>
            `;
        }
        
        function updatePlot() {
            const well = currentWell;
            const timeSeries = well.time_series;
            
            // Main oxygen trace
            const oxygenTrace = {
                x: timeSeries.time,
                y: timeSeries.oxygen,
                type: 'scatter',
                mode: 'lines',
                name: 'Oxygen Consumption',
                line: { color: '#1f77b4', width: 2 }
            };
            
            const traces = [oxygenTrace];
            
            // Add media change events as vertical lines
            well.media_change_events.forEach((eventTime, i) => {
                traces.push({
                    x: [eventTime, eventTime],
                    y: [well.data_range.oxygen_min, well.data_range.oxygen_max],
                    type: 'scatter',
                    mode: 'lines',
                    name: i === 0 ? 'Media Changes' : '',
                    showlegend: i === 0,
                    line: { color: 'red', width: 2, dash: 'dash' },
                    hoverinfo: 'x',
                    hovertemplate: 'Media Change<br>Time: %{x:.1f}h<extra></extra>'
                });
            });
            
            // Add period boundaries as vertical lines
            currentPeriods.forEach((period, i) => {
                if (period.start > well.data_range.time_min) {
                    traces.push({
                        x: [period.start, period.start],
                        y: [well.data_range.oxygen_min, well.data_range.oxygen_max],
                        type: 'scatter',
                        mode: 'lines',
                        name: i === 0 ? 'Period Boundaries' : '',
                        showlegend: i === 0,
                        line: { color: 'green', width: 3 },
                        hoverinfo: 'x',
                        hovertemplate: 'Period Boundary<br>Time: %{x:.1f}h<extra></extra>'
                    });
                }
            });
            
            const layout = {
                title: {
                    text: `${well.drug} (${well.concentration}ŒºM) - Well ${well.well_id.substring(0, 8)}...`,
                    font: { size: 16 }
                },
                xaxis: {
                    title: 'Time (hours)',
                    showgrid: true,
                    zeroline: false
                },
                yaxis: {
                    title: 'Oxygen Consumption (%)',
                    showgrid: true,
                    zeroline: true
                },
                hovermode: 'x unified',
                dragmode: 'select',
                selectdirection: 'horizontal'
            };
            
            const config = {
                responsive: true,
                displayModeBar: true,
                modeBarButtonsToRemove: ['lasso2d', 'select2d'],
                displaylogo: false
            };
            
            Plotly.newPlot('plotly-div', traces, layout, config).then(() => {
                // Add click handler for adding boundaries
                document.getElementById('plotly-div').on('plotly_click', function(data) {
                    if (data.points.length > 0) {
                        const clickTime = data.points[0].x;
                        document.getElementById('addPeriodTime').value = clickTime.toFixed(1);
                    }
                });
            });
        }
        
        function updatePeriodList() {
            const container = document.getElementById('periodItems');
            container.innerHTML = '';
            
            currentPeriods.forEach((period, index) => {
                const div = document.createElement('div');
                div.className = 'period-item';
                div.innerHTML = `
                    <div>
                        <strong>Period ${period.period_number}</strong><br>
                        <small>${period.start.toFixed(1)}h - ${period.end.toFixed(1)}h (${period.duration.toFixed(1)}h duration)</small>
                    </div>
                    <div>
                        <button onclick="removePeriod(${index})" class="danger-btn" style="font-size: 12px; padding: 4px 8px;">Remove</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function addPeriodBoundary() {
            const timeInput = document.getElementById('addPeriodTime');
            const time = parseFloat(timeInput.value);
            
            if (isNaN(time)) {
                showStatus('Please enter a valid time value', 'error');
                return;
            }
            
            const well = currentWell;
            if (time < well.data_range.time_min || time > well.data_range.time_max) {
                showStatus('Time must be within the data range', 'error');
                return;
            }
            
            // Check if boundary already exists nearby (within 5 hours)
            const existingBoundary = currentPeriods.find(p => Math.abs(p.start - time) < 5 || Math.abs(p.end - time) < 5);
            if (existingBoundary) {
                showStatus('Boundary too close to existing boundary', 'error');
                return;
            }
            
            // Add the boundary by splitting an existing period
            let splitPeriod = null;
            for (let i = 0; i < currentPeriods.length; i++) {
                if (time > currentPeriods[i].start && time < currentPeriods[i].end) {
                    splitPeriod = i;
                    break;
                }
            }
            
            if (splitPeriod !== null) {
                const originalPeriod = currentPeriods[splitPeriod];
                
                // Create two new periods
                const period1 = {
                    ...originalPeriod,
                    end: time,
                    duration: time - originalPeriod.start
                };
                
                const period2 = {
                    ...originalPeriod,
                    period_number: originalPeriod.period_number + 0.5, // Temporary number
                    start: time,
                    duration: originalPeriod.end - time
                };
                
                // Replace the original period with the two new ones
                currentPeriods.splice(splitPeriod, 1, period1, period2);
                
                // Renumber all periods
                currentPeriods.forEach((period, index) => {
                    period.period_number = index + 1;
                });
                
                modifications.push({
                    type: 'split',
                    time: time,
                    original_period: originalPeriod.period_number
                });
                
                updatePlot();
                updatePeriodList();
                updateModifications();
                
                showStatus(`Added boundary at ${time.toFixed(1)}h`, 'success');
                timeInput.value = '';
            } else {
                showStatus('Time must be within an existing period', 'error');
            }
        }
        
        function removePeriod(index) {
            if (currentPeriods.length <= 1) {
                showStatus('Cannot remove the last period', 'error');
                return;
            }
            
            const removedPeriod = currentPeriods[index];
            
            // If removing a middle period, merge with adjacent period
            if (index > 0) {
                // Merge with previous period
                currentPeriods[index - 1].end = removedPeriod.end;
                currentPeriods[index - 1].duration = currentPeriods[index - 1].end - currentPeriods[index - 1].start;
            } else if (index < currentPeriods.length - 1) {
                // Merge with next period
                currentPeriods[index + 1].start = removedPeriod.start;
                currentPeriods[index + 1].duration = currentPeriods[index + 1].end - currentPeriods[index + 1].start;
            }
            
            currentPeriods.splice(index, 1);
            
            // Renumber periods
            currentPeriods.forEach((period, i) => {
                period.period_number = i + 1;
            });
            
            modifications.push({
                type: 'remove',
                period_number: removedPeriod.period_number
            });
            
            updatePlot();
            updatePeriodList();
            updateModifications();
            
            showStatus(`Removed period ${removedPeriod.period_number}`, 'success');
        }
        
        function resetPeriods() {
            currentPeriods = JSON.parse(JSON.stringify(originalPeriods));
            modifications = [];
            
            updatePlot();
            updatePeriodList();
            updateModifications();
            
            showStatus('Reset to original periods', 'success');
        }
        
        function autoDetectPeriods() {
            // Simplified auto-detection based on variance spikes
            // This would call the backend detection algorithm in a real implementation
            showStatus('Auto-detection not implemented in demo version', 'error');
        }
        
        function updateModifications() {
            const container = document.getElementById('modificationsList');
            const modificationsDiv = document.getElementById('modifications');
            
            if (modifications.length === 0) {
                modificationsDiv.classList.remove('show');
                return;
            }
            
            modificationsDiv.classList.add('show');
            
            container.innerHTML = modifications.map(mod => {
                if (mod.type === 'split') {
                    return `<div>Split period ${mod.original_period} at ${mod.time.toFixed(1)}h</div>`;
                } else if (mod.type === 'remove') {
                    return `<div>Removed period ${mod.period_number}</div>`;
                }
                return `<div>${JSON.stringify(mod)}</div>`;
            }).join('');
        }
        
        function exportCorrections() {
            if (modifications.length === 0) {
                showStatus('No modifications to export', 'error');
                return;
            }
            
            const correctionData = {
                well_id: currentWell.well_id,
                plate_id: currentWell.plate_id,
                drug: currentWell.drug,
                concentration: currentWell.concentration,
                original_periods: originalPeriods,
                corrected_periods: currentPeriods,
                modifications: modifications,
                timestamp: new Date().toISOString()
            };
            
            console.log('Correction data:', correctionData);
            showStatus('Correction data logged to console and ready for export', 'success');
            
            return correctionData;
        }
        
        function downloadCorrections() {
            const data = exportCorrections();
            if (!data) return;
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `period_corrections_${currentWell.well_id.substring(0, 8)}_${Date.now()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showStatus('Downloaded correction file', 'success');
        }
        
        function copyToClipboard() {
            const data = exportCorrections();
            if (!data) return;
            
            navigator.clipboard.writeText(JSON.stringify(data, null, 2)).then(() => {
                showStatus('Copied correction data to clipboard', 'success');
            }).catch(() => {
                showStatus('Failed to copy to clipboard', 'error');
            });
        }
        
        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = message;
            statusDiv.className = `status-message status-${type}`;
            statusDiv.style.display = 'block';
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 3000);
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
    